<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAGç³»ç»ŸV2.0æ¶æ„ - æ•°æ®æµåŠ¨å¯è§†åŒ–ä½“éªŒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeInDown 0.8s;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ä¸»å¸ƒå±€ï¼šå·¦ä¾§æ§åˆ¶é¢æ¿ï¼Œä¸­é—´æµç¨‹å›¾ï¼Œå³ä¾§æ•°æ®é¢æ¿ */
        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr 350px;
            gap: 20px;
            margin-bottom: 30px;
        }

        /* å·¦ä¾§æ§åˆ¶é¢æ¿ */
        .control-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            color: #2a5298;
            margin-bottom: 15px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-section h3 span {
            font-size: 1.2em;
        }

        .mode-selector {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .mode-btn {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: 0.95em;
        }

        .mode-btn:hover {
            border-color: #2a5298;
            transform: translateX(5px);
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .query-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            margin-bottom: 10px;
            transition: border-color 0.3s;
        }

        .query-input:focus {
            outline: none;
            border-color: #2a5298;
        }

        .action-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .action-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* ä¸­é—´æµç¨‹å¯è§†åŒ–åŒºåŸŸ */
        .flow-visualization {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            min-height: 700px;
        }

        /* SVGç®¡é“ç³»ç»Ÿ */
        .pipeline-svg {
            width: 100%;
            height: 100%;
        }

        /* æµç¨‹èŠ‚ç‚¹ */
        .flow-node {
            fill: #f0f4ff;
            stroke: #667eea;
            stroke-width: 2;
            cursor: pointer;
            transition: all 0.3s;
        }

        .flow-node.active {
            fill: #667eea;
            stroke-width: 3;
            filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.5));
        }

        .flow-node.completed {
            fill: #d4edda;
            stroke: #28a745;
        }

        .flow-node.error {
            fill: #f8d7da;
            stroke: #dc3545;
        }

        .node-text {
            fill: #333;
            font-size: 12px;
            text-anchor: middle;
            pointer-events: none;
        }

        .node-text.active {
            fill: white;
            font-weight: bold;
        }

        /* æ•°æ®æµåŠ¨åŠ¨ç”» */
        .data-flow {
            fill: #ffc107;
            r: 8;
            filter: drop-shadow(0 0 6px rgba(255, 193, 7, 0.6));
        }

        @keyframes flowAnimation {
            0% { offset-distance: 0%; }
            100% { offset-distance: 100%; }
        }

        /* ç®¡é“è¿çº¿ */
        .pipeline-path {
            fill: none;
            stroke: #e0e0e0;
            stroke-width: 3;
            stroke-dasharray: 5, 5;
        }

        .pipeline-path.active {
            stroke: #667eea;
            stroke-dasharray: none;
            animation: pulseStroke 1s infinite;
        }

        @keyframes pulseStroke {
            0%, 100% { stroke-width: 3; }
            50% { stroke-width: 5; }
        }

        /* å³ä¾§æ•°æ®é¢æ¿ */
        .data-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow-y: auto;
            max-height: 700px;
        }

        .data-section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .data-section:last-child {
            border-bottom: none;
        }

        .data-section h4 {
            color: #2a5298;
            margin-bottom: 10px;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .data-content {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-word;
        }

        .data-content.json {
            color: #2a5298;
        }

        .data-content.vector {
            color: #28a745;
        }

        .data-content.result {
            color: #dc3545;
        }

        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-indicator.waiting {
            background: #f0f4ff;
            color: #667eea;
        }

        .status-indicator.processing {
            background: #fff3cd;
            color: #856404;
            animation: pulse 1.5s infinite;
        }

        .status-indicator.completed {
            background: #d4edda;
            color: #155724;
        }

        .status-indicator.error {
            background: #f8d7da;
            color: #721c24;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* é˜¶æ®µæ ‡é¢˜ */
        .stage-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.2em;
            font-weight: 600;
        }

        /* è¯¦ç»†è§£é‡Šå¼¹çª— */
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9em;
            max-width: 300px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .tooltip.show {
            opacity: 1;
        }

        /* æ€§èƒ½æŒ‡æ ‡ */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .metric-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #2a5298;
        }

        .metric-label {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }

        /* è·¯ç”±å†³ç­–å¯è§†åŒ– */
        .router-decision {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .router-decision h5 {
            color: #856404;
            margin-bottom: 10px;
        }

        .decision-path {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }

        .decision-node {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .decision-node.selected {
            background: #28a745;
            color: white;
        }

        .decision-node.not-selected {
            background: #e0e0e0;
            color: #999;
        }

        .decision-arrow {
            color: #667eea;
            font-size: 1.2em;
        }

        /* æ¨¡å‹åˆ‡æ¢åŠ¨ç”» */
        .model-switch {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            background: #f0f4ff;
            border-radius: 10px;
            margin: 20px 0;
        }

        .model-card {
            padding: 15px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
        }

        .model-card.active {
            border-color: #667eea;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .model-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .switch-arrow {
            font-size: 2em;
            color: #667eea;
            animation: slideRight 1s infinite;
        }

        @keyframes slideRight {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }

        /* åº•éƒ¨æ§åˆ¶æ  */
        .bottom-controls {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .speed-slider {
            width: 150px;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 0 20px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* æ•™å­¦å¡ç‰‡ */
        .education-card {
            background: linear-gradient(135deg, #f0f4ff 0%, #e8eeff 100%);
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            position: relative;
        }
        
        .education-card h5 {
            color: #2a5298;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .education-card .concept {
            background: white;
            padding: 10px;
            border-radius: 8px;
            margin: 8px 0;
            border-left: 4px solid #667eea;
        }
        
        .education-card .concept strong {
            color: #667eea;
        }
        
        /* æ¶æ„å›¾ */
        .architecture-diagram {
            background: white;
            border: 2px dashed #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
        }
        
        .architecture-layer {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .architecture-layer .layer-name {
            font-weight: bold;
            color: #2a5298;
        }
        
        .architecture-layer .layer-tech {
            color: #666;
            font-size: 0.9em;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1400px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .control-panel,
            .data-panel {
                max-width: 100%;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .spinner {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #667eea;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ RAGç³»ç»ŸV2.0æ¶æ„ - æ•°æ®æµåŠ¨å¯è§†åŒ–</h1>
            <p>è·Ÿéšæ•°æ®çš„æ—…ç¨‹ï¼Œä½“éªŒåŒæ¨¡å‹æ™ºèƒ½è·¯ç”±çš„å®Œæ•´å¤„ç†æµç¨‹</p>
            <div style="margin-top: 15px; font-size: 0.95em; opacity: 0.9;">
                <span style="margin: 0 10px;">ğŸ“š è¯¾ç¨‹RAGç³»ç»Ÿ</span>
                <span style="margin: 0 10px;">ğŸ¤– DeepSeekåŒæ¨¡å‹</span>
                <span style="margin: 0 10px;">ğŸ” å‘é‡è¯­ä¹‰æœç´¢</span>
                <span style="margin: 0 10px;">âš¡ å®æ—¶å¤„ç†æµç¨‹</span>
            </div>
        </div>

        <div class="main-layout">
            <!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
            <div class="control-panel">
                <div class="control-section">
                    <h3><span>ğŸ®</span> ç³»ç»Ÿæ¨¡å¼</h3>
                    <div class="mode-selector">
                        <button class="mode-btn active" onclick="switchMode('dev')">
                            ğŸ› ï¸ å¼€å‘æ€ - ç³»ç»Ÿé…ç½®
                            <div style="font-size: 0.8em; color: #666; margin-top: 4px;">åˆå§‹åŒ–ç³»ç»Ÿç»„ä»¶</div>
                        </button>
                        <button class="mode-btn" onclick="switchMode('manage')">
                            ğŸ“‹ ç®¡ç†æ€ - æ–‡æ¡£å¤„ç†
                            <div style="font-size: 0.8em; color: #666; margin-top: 4px;">å¤„ç†è¯¾ç¨‹ææ–™</div>
                        </button>
                        <button class="mode-btn" onclick="switchMode('runtime')">
                            ğŸš€ è¿è¡Œæ€ - æŸ¥è¯¢å¤„ç†
                            <div style="font-size: 0.8em; color: #666; margin-top: 4px;">V2.0å®Œæ•´æµç¨‹</div>
                        </button>
                    </div>
                </div>

                <div class="control-section" id="runtime-controls" style="display: none;">
                    <h3><span>ğŸ”</span> æŸ¥è¯¢è¾“å…¥</h3>
                    <select class="query-input" id="query-presets" onchange="updateQueryInput()" style="margin-bottom: 8px;">
                        <option value="Pythonçš„åŸºæœ¬æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿ">ğŸ“š è¯¾ç¨‹å†…å®¹æŸ¥è¯¢ï¼ˆéœ€è¦æœç´¢ï¼‰</option>
                        <option value="ä»€ä¹ˆæ˜¯ç¼–ç¨‹ï¼Ÿ">ğŸ’­ ä¸€èˆ¬çŸ¥è¯†é—®ç­”ï¼ˆç›´æ¥æ¨ç†ï¼‰</option>
                        <option value="Pythonä¸­å¦‚ä½•å®šä¹‰å‡½æ•°ï¼Ÿ">ğŸ”§ ç¼–ç¨‹æŠ€æœ¯é—®é¢˜ï¼ˆå·¥å…·è°ƒç”¨ï¼‰</option>
                    </select>
                    <input type="text" class="query-input" id="user-query" 
                           placeholder="è¾“å…¥ä½ çš„é—®é¢˜..." 
                           value="Pythonçš„åŸºæœ¬æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿ">
                    <button class="action-btn" onclick="startQueryProcess()">
                        å¼€å§‹å¤„ç†æŸ¥è¯¢
                    </button>
                    <div style="margin-top: 10px; padding: 10px; background: #f0f4ff; border-radius: 8px; font-size: 0.85em;">
                        <strong>ğŸ’¡ æç¤ºï¼š</strong>ä¸åŒç±»å‹çš„æŸ¥è¯¢ä¼šè§¦å‘ä¸åŒçš„å¤„ç†è·¯å¾„
                    </div>
                </div>

                <div class="control-section" id="dev-controls">
                    <h3><span>âš™ï¸</span> é…ç½®å‚æ•°</h3>
                    <div style="margin-bottom: 10px;">
                        <label style="font-size: 0.9em; color: #666;">æ¨¡å‹é€‰æ‹©</label>
                        <select id="model-provider" class="query-input" onchange="updateModelConfig()">
                            <option value="deepseek">DeepSeekåŒæ¨¡å‹ï¼ˆV3+R1ï¼‰</option>
                            <option value="claude">Claudeå•æ¨¡å‹ï¼ˆåå¤‡ï¼‰</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 8px; font-size: 0.85em;">
                        <div><strong>ğŸ”§ DeepSeek-V3:</strong> å·¥å…·è°ƒç”¨ä¸“ç”¨</div>
                        <div><strong>ğŸ§  DeepSeek-R1:</strong> æ¨ç†æ•´åˆä¸“ç”¨</div>
                        <div><strong>ğŸ“‹ Claude:</strong> é™çº§åå¤‡æ–¹æ¡ˆ</div>
                    </div>
                    <button class="action-btn" onclick="initializeSystem()">
                        åˆå§‹åŒ–ç³»ç»Ÿ
                    </button>
                </div>

                <div class="control-section" id="manage-controls" style="display: none;">
                    <h3><span>ğŸ“„</span> æ–‡æ¡£ç®¡ç†</h3>
                    <select class="query-input" id="doc-type" style="margin-bottom: 10px;">
                        <option value="python">Pythonç¼–ç¨‹åŸºç¡€.md</option>
                        <option value="web">Webå¼€å‘å…¥é—¨.pdf</option>
                        <option value="data">æ•°æ®åˆ†æè¯¾ç¨‹.txt</option>
                    </select>
                    <button class="action-btn" onclick="processDocument()">
                        å¤„ç†è¯¾ç¨‹æ–‡æ¡£
                    </button>
                    <div style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 8px; font-size: 0.85em;">
                        <strong>å¤„ç†æµç¨‹ï¼š</strong><br/>
                        1. æ–‡æ¡£è§£ææå–å†…å®¹<br/>
                        2. åˆ†å—(500å­—ç¬¦, 100é‡å )<br/>
                        3. å‘é‡åŒ–(384ç»´)<br/>
                        4. å­˜å‚¨åˆ°ChromaDB
                    </div>
                </div>

                <div class="control-section">
                    <h3><span>ğŸ“Š</span> ç³»ç»ŸçŠ¶æ€</h3>
                    <div id="system-status">
                        <span class="status-indicator waiting">
                            â¸ï¸ ç­‰å¾…æ“ä½œ
                        </span>
                    </div>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-value" id="time-metric">0.0s</div>
                            <div class="metric-label">å¤„ç†æ—¶é—´</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value" id="token-metric">0</div>
                            <div class="metric-label">Tokenæ•°</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value" id="chunks-metric">0</div>
                            <div class="metric-label">æ–‡æ¡£å—æ•°</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value" id="cost-metric">$0.00</div>
                            <div class="metric-label">é¢„ä¼°æˆæœ¬</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¸­é—´æµç¨‹å¯è§†åŒ– -->
            <div class="flow-visualization">
                <div class="stage-title" id="stage-title">ğŸ› ï¸ å¼€å‘æ€ - ç³»ç»Ÿåˆå§‹åŒ–</div>
                
                <!-- å¼€å‘æ€å¯è§†åŒ– -->
                <div id="dev-flow" class="flow-content">
                    <!-- æ•™å­¦å¡ç‰‡ï¼šç³»ç»Ÿåˆå§‹åŒ– -->
                    <div class="education-card">
                        <h5>ğŸ“ ç³»ç»Ÿåˆå§‹åŒ–æ¦‚å¿µ</h5>
                        <div class="concept">
                            <strong>Whyï¼ˆä¸ºä»€ä¹ˆï¼‰ï¼š</strong>ç³»ç»Ÿéœ€è¦åŠ è½½é…ç½®ã€è¿æ¥æ•°æ®åº“ã€åˆå§‹åŒ–æ¨¡å‹
                        </div>
                        <div class="concept">
                            <strong>Whatï¼ˆæ˜¯ä»€ä¹ˆï¼‰ï¼š</strong>è¯»å–ç¯å¢ƒå˜é‡ã€å¯åŠ¨å„ä¸ªç»„ä»¶ã€å»ºç«‹è¿æ¥
                        </div>
                        <div class="concept">
                            <strong>Howï¼ˆæ€ä¹ˆåšï¼‰ï¼š</strong>æŒ‰é¡ºåºåŠ è½½é…ç½®â†’æ•°æ®åº“â†’åµŒå…¥æ¨¡å‹â†’AIæ¥å£â†’è·¯ç”±å™¨
                        </div>
                    </div>
                    
                    <svg class="pipeline-svg" viewBox="0 0 800 600">
                        <!-- é…ç½®è¯»å– -->
                        <rect x="50" y="50" width="120" height="60" rx="10" class="flow-node" id="config-node"/>
                        <text x="110" y="85" class="node-text">é…ç½®è¯»å–</text>
                        
                        <!-- å‘é‡æ•°æ®åº“ -->
                        <rect x="250" y="50" width="120" height="60" rx="10" class="flow-node" id="vectordb-node"/>
                        <text x="310" y="85" class="node-text">å‘é‡æ•°æ®åº“</text>
                        
                        <!-- åµŒå…¥æ¨¡å‹ -->
                        <rect x="450" y="50" width="120" height="60" rx="10" class="flow-node" id="embedding-node"/>
                        <text x="510" y="85" class="node-text">åµŒå…¥æ¨¡å‹</text>
                        
                        <!-- AIæ¨¡å‹é…ç½® -->
                        <rect x="250" y="200" width="120" height="60" rx="10" class="flow-node" id="ai-config-node"/>
                        <text x="310" y="235" class="node-text">AIæ¨¡å‹é…ç½®</text>
                        
                        <!-- è·¯ç”±å™¨åˆå§‹åŒ– -->
                        <rect x="450" y="200" width="120" height="60" rx="10" class="flow-node" id="router-node"/>
                        <text x="510" y="235" class="node-text">æ™ºèƒ½è·¯ç”±å™¨</text>
                        
                        <!-- è¿æ¥çº¿ -->
                        <path d="M170,80 L250,80" class="pipeline-path" id="path1"/>
                        <path d="M370,80 L450,80" class="pipeline-path" id="path2"/>
                        <path d="M310,110 L310,200" class="pipeline-path" id="path3"/>
                        <path d="M370,230 L450,230" class="pipeline-path" id="path4"/>
                    </svg>
                </div>

                <!-- ç®¡ç†æ€å¯è§†åŒ– -->
                <div id="manage-flow" class="flow-content" style="display: none;">
                    <!-- æ•™å­¦å¡ç‰‡ï¼šæ–‡æ¡£å¤„ç†æµç¨‹ -->
                    <div class="education-card">
                        <h5>ğŸ“ æ–‡æ¡£å¤„ç†æµç¨‹</h5>
                        <div class="concept">
                            <strong>ğŸ“¥ è¾“å…¥ï¼š</strong>è¯¾ç¨‹æ–‡æ¡£ï¼ˆMD/PDF/TXTæ ¼å¼ï¼‰
                        </div>
                        <div class="concept">
                            <strong>âœ‚ï¸ åˆ†å—ï¼š</strong>500å­—ç¬¦/å—ï¼Œ100å­—ç¬¦é‡å ï¼Œä¿è¯ä¸Šä¸‹æ–‡è¿è´¯
                        </div>
                        <div class="concept">
                            <strong>ğŸ”¢ å‘é‡åŒ–ï¼š</strong>all-MiniLM-L6-v2æ¨¡å‹ï¼Œ384ç»´å‘é‡ç©ºé—´
                        </div>
                        <div class="concept">
                            <strong>ğŸ’¾ å­˜å‚¨ï¼š</strong>ChromaDBå‘é‡æ•°æ®åº“ï¼Œæ”¯æŒå¿«é€Ÿç›¸ä¼¼åº¦æœç´¢
                        </div>
                    </div>
                    
                    <svg class="pipeline-svg" viewBox="0 0 800 600">
                        <!-- æ–‡æ¡£è¾“å…¥ -->
                        <rect x="50" y="50" width="120" height="60" rx="10" class="flow-node" id="doc-input-node"/>
                        <text x="110" y="85" class="node-text">æ–‡æ¡£è¾“å…¥</text>
                        
                        <!-- æ–‡æ¡£è§£æ -->
                        <rect x="250" y="50" width="120" height="60" rx="10" class="flow-node" id="doc-parse-node"/>
                        <text x="310" y="85" class="node-text">æ–‡æ¡£è§£æ</text>
                        
                        <!-- æ–‡æœ¬åˆ†å— -->
                        <rect x="450" y="50" width="120" height="60" rx="10" class="flow-node" id="chunk-node"/>
                        <text x="510" y="85" class="node-text">æ–‡æœ¬åˆ†å—</text>
                        
                        <!-- å‘é‡åŒ– -->
                        <rect x="650" y="50" width="120" height="60" rx="10" class="flow-node" id="vectorize-node"/>
                        <text x="710" y="85" class="node-text">å‘é‡åŒ–</text>
                        
                        <!-- å­˜å‚¨ -->
                        <rect x="350" y="200" width="120" height="60" rx="10" class="flow-node" id="store-node"/>
                        <text x="410" y="235" class="node-text">æ•°æ®åº“å­˜å‚¨</text>
                        
                        <!-- è¿æ¥çº¿ -->
                        <path d="M170,80 L250,80" class="pipeline-path"/>
                        <path d="M370,80 L450,80" class="pipeline-path"/>
                        <path d="M570,80 L650,80" class="pipeline-path"/>
                        <path d="M710,110 L710,150 L470,150 L470,200 L410,200" class="pipeline-path"/>
                    </svg>
                </div>

                <!-- è¿è¡Œæ€å¯è§†åŒ– - å®Œæ•´V2.0æµç¨‹ -->
                <div id="runtime-flow" class="flow-content" style="display: none;">
                    <!-- æ•™å­¦å¡ç‰‡ï¼šV2.0æ¶æ„ç‰¹æ€§ -->
                    <div class="education-card">
                        <h5>ğŸ“ V2.0åŒæ¨¡å‹æ™ºèƒ½è·¯ç”±æ¶æ„</h5>
                        <div class="concept">
                            <strong>ğŸ¤– åŒæ¨¡å‹ååŒï¼š</strong>
                            <span style="color: #28a745;">â— DeepSeek-V3</span> å·¥å…·è°ƒç”¨ä¸“å®¶ + 
                            <span style="color: #dc3545;">â— DeepSeek-R1</span> æ¨ç†æ•´åˆä¸“å®¶
                        </div>
                        <div class="concept">
                            <strong>ğŸš€ æ™ºèƒ½è·¯ç”±ï¼š</strong>æ ¹æ®ä»»åŠ¡ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹è·¯å¾„
                        </div>
                        <div class="concept">
                            <strong>ğŸ”„ æ¨¡å‹åˆ‡æ¢ï¼š</strong>V3å®Œæˆå·¥å…·è°ƒç”¨åè‡ªåŠ¨åˆ‡æ¢åˆ°R1è¿›è¡Œç»“æœæ•´åˆ
                        </div>
                        <div class="concept">
                            <strong>ğŸ›¡ï¸ é™çº§æœºåˆ¶ï¼š</strong>DeepSeekå¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ°Claude API
                        </div>
                    </div>
                    
                    <svg class="pipeline-svg" viewBox="0 0 800 600">
                        <!-- ç”¨æˆ·è¾“å…¥ -->
                        <rect x="50" y="50" width="100" height="50" rx="10" class="flow-node" id="user-input"/>
                        <text x="100" y="80" class="node-text">ç”¨æˆ·è¾“å…¥</text>
                        
                        <!-- APIæ¥æ”¶ -->
                        <rect x="200" y="50" width="100" height="50" rx="10" class="flow-node" id="api-receive"/>
                        <text x="250" y="80" class="node-text">APIæ¥æ”¶</text>
                        
                        <!-- ä¼šè¯ç®¡ç† -->
                        <rect x="350" y="50" width="100" height="50" rx="10" class="flow-node" id="session-mgmt"/>
                        <text x="400" y="80" class="node-text">ä¼šè¯ç®¡ç†</text>
                        
                        <!-- å·¥å…·å‡†å¤‡ -->
                        <rect x="500" y="50" width="100" height="50" rx="10" class="flow-node" id="tool-prep"/>
                        <text x="550" y="80" class="node-text">å·¥å…·å‡†å¤‡</text>
                        
                        <!-- è·¯ç”±å†³ç­– -->
                        <rect x="325" y="150" width="150" height="50" rx="10" class="flow-node" id="router-decision"/>
                        <text x="400" y="180" class="node-text">ğŸš¦ è·¯ç”±å†³ç­–</text>
                        
                        <!-- å·¦åˆ†æ”¯ï¼šå·¥å…·è°ƒç”¨è·¯å¾„ -->
                        <rect x="150" y="250" width="120" height="50" rx="10" class="flow-node" id="model-v3"/>
                        <text x="210" y="280" class="node-text">DeepSeek-V3</text>
                        
                        <rect x="150" y="330" width="120" height="50" rx="10" class="flow-node" id="tool-call"/>
                        <text x="210" y="360" class="node-text">å·¥å…·è°ƒç”¨</text>
                        
                        <rect x="150" y="410" width="120" height="50" rx="10" class="flow-node" id="vector-search"/>
                        <text x="210" y="440" class="node-text">å‘é‡æœç´¢</text>
                        
                        <!-- å³åˆ†æ”¯ï¼šç›´æ¥æ¨ç†è·¯å¾„ -->
                        <rect x="480" y="250" width="120" height="50" rx="10" class="flow-node" id="model-r1-direct"/>
                        <text x="540" y="280" class="node-text">DeepSeek-R1</text>
                        
                        <!-- æ¨¡å‹åˆ‡æ¢ -->
                        <rect x="325" y="330" width="150" height="50" rx="10" class="flow-node" id="model-switch"/>
                        <text x="400" y="360" class="node-text">ğŸ”„ æ¨¡å‹åˆ‡æ¢</text>
                        
                        <!-- ç»“æœæ•´åˆ -->
                        <rect x="325" y="410" width="150" height="50" rx="10" class="flow-node" id="result-integrate"/>
                        <text x="400" y="440" class="node-text">ç»“æœæ•´åˆ R1</text>
                        
                        <!-- æœ€ç»ˆå“åº” -->
                        <rect x="325" y="500" width="150" height="50" rx="10" class="flow-node" id="final-response"/>
                        <text x="400" y="530" class="node-text">ğŸ“¤ æœ€ç»ˆå“åº”</text>
                        
                        <!-- è¿æ¥çº¿ - ä¸»æµç¨‹ -->
                        <path d="M150,75 L200,75" class="pipeline-path"/>
                        <path d="M300,75 L350,75" class="pipeline-path"/>
                        <path d="M450,75 L500,75" class="pipeline-path"/>
                        <path d="M550,100 L550,130 L400,130 L400,150" class="pipeline-path"/>
                        
                        <!-- å·¦åˆ†æ”¯è¿çº¿ -->
                        <path d="M325,175 L210,175 L210,250" class="pipeline-path" id="tool-path"/>
                        <path d="M210,300 L210,330" class="pipeline-path"/>
                        <path d="M210,380 L210,410" class="pipeline-path"/>
                        <path d="M270,435 L325,435" class="pipeline-path"/>
                        
                        <!-- å³åˆ†æ”¯è¿çº¿ -->
                        <path d="M475,175 L540,175 L540,250" class="pipeline-path" id="direct-path"/>
                        <path d="M540,300 L540,345 L475,345" class="pipeline-path"/>
                        
                        <!-- æ¨¡å‹åˆ‡æ¢è¿çº¿ -->
                        <path d="M270,275 L325,275 L325,330" class="pipeline-path"/>
                        <path d="M400,380 L400,410" class="pipeline-path"/>
                        <path d="M400,460 L400,500" class="pipeline-path"/>
                        
                        <!-- æ•°æ®æµåŠ¨ç‚¹ -->
                        <circle class="data-flow" id="data-ball" style="display: none;">
                            <animateMotion dur="2s" repeatCount="1" fill="freeze">
                                <mpath href="#flow-path"/>
                            </animateMotion>
                        </circle>
                    </svg>
                    
                    <!-- è·¯ç”±å†³ç­–è¯¦æƒ… -->
                    <div class="router-decision" id="router-details" style="display: none;">
                        <h5>ğŸš¦ æ™ºèƒ½è·¯ç”±å†³ç­–è¿‡ç¨‹</h5>
                        <div class="decision-path">
                            <div class="decision-node" id="check-tools">æ£€æŸ¥å·¥å…·éœ€æ±‚</div>
                            <span class="decision-arrow">â†’</span>
                            <div class="decision-node" id="select-model">é€‰æ‹©æ¨¡å‹</div>
                            <span class="decision-arrow">â†’</span>
                            <div class="decision-node" id="route-path">ç¡®å®šè·¯å¾„</div>
                        </div>
                    </div>
                    
                    <!-- æ¨¡å‹åˆ‡æ¢åŠ¨ç”» -->
                    <div class="model-switch" id="model-switch-viz" style="display: none;">
                        <div class="model-card" id="v3-card">
                            <div class="model-icon">ğŸ”§</div>
                            <strong>DeepSeek-V3</strong>
                            <div style="font-size: 0.9em; color: #666;">å·¥å…·è°ƒç”¨å®Œæˆ</div>
                        </div>
                        <span class="switch-arrow">â†’</span>
                        <div class="model-card" id="r1-card">
                            <div class="model-icon">ğŸ§ </div>
                            <strong>DeepSeek-R1</strong>
                            <div style="font-size: 0.9em; color: #666;">ç»“æœæ•´åˆ</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§æ•°æ®é¢æ¿ -->
            <div class="data-panel">
                <h3 style="margin-bottom: 20px; color: #2a5298;">ğŸ“Š å®æ—¶æ•°æ®ç›‘æ§</h3>
                
                <!-- æ¶æ„å±‚æ¬¡æ˜¾ç¤º -->
                <div id="architecture-layers" style="display: none;">
                    <div class="architecture-diagram">
                        <h5 style="color: #2a5298; margin-bottom: 15px;">ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å±‚æ¬¡</h5>
                        <div class="architecture-layer">
                            <span class="layer-name">ğŸŒ APIå±‚</span>
                            <span class="layer-tech">FastAPI + Uvicorn</span>
                        </div>
                        <div class="architecture-layer">
                            <span class="layer-name">ğŸ§  AIå±‚</span>
                            <span class="layer-tech">DeepSeek R1/V3</span>
                        </div>
                        <div class="architecture-layer">
                            <span class="layer-name">ğŸ” æœç´¢å±‚</span>
                            <span class="layer-tech">Vector Search</span>
                        </div>
                        <div class="architecture-layer">
                            <span class="layer-name">ğŸ—Œï¸ å­˜å‚¨å±‚</span>
                            <span class="layer-tech">ChromaDB</span>
                        </div>
                    </div>
                </div>
                
                <!-- å½“å‰æ•°æ® -->
                <div class="data-section">
                    <h4><span>ğŸ“¥</span> è¾“å…¥æ•°æ®</h4>
                    <div class="data-content" id="input-data">
                        ç­‰å¾…è¾“å…¥...
                    </div>
                </div>
                
                <!-- å¤„ç†ä¸­æ•°æ® -->
                <div class="data-section">
                    <h4><span>âš™ï¸</span> å¤„ç†ä¸­</h4>
                    <div class="data-content json" id="processing-data">
                        ç­‰å¾…å¤„ç†...
                    </div>
                </div>
                
                <!-- å‘é‡æ•°æ® -->
                <div class="data-section" id="vector-section" style="display: none;">
                    <h4><span>ğŸ”¢</span> å‘é‡è¡¨ç¤º</h4>
                    <div class="data-content vector" id="vector-data">
                        ç­‰å¾…å‘é‡åŒ–...
                    </div>
                </div>
                
                <!-- æœç´¢ç»“æœ -->
                <div class="data-section" id="search-section" style="display: none;">
                    <h4><span>ğŸ”</span> æœç´¢ç»“æœ</h4>
                    <div class="data-content" id="search-results">
                        ç­‰å¾…æœç´¢...
                    </div>
                </div>
                
                <!-- è¾“å‡ºæ•°æ® -->
                <div class="data-section">
                    <h4><span>ğŸ“¤</span> è¾“å‡ºç»“æœ</h4>
                    <div class="data-content result" id="output-data">
                        ç­‰å¾…è¾“å‡º...
                    </div>
                </div>
                
                <!-- æ—¥å¿— -->
                <div class="data-section">
                    <h4><span>ğŸ“</span> å¤„ç†æ—¥å¿—</h4>
                    <div class="data-content" id="process-log" style="max-height: 150px;">
                        [ç³»ç»Ÿ] å‡†å¤‡å°±ç»ª
                    </div>
                </div>
            </div>
        </div>

        <!-- åº•éƒ¨æ§åˆ¶æ  -->
        <div class="bottom-controls">
            <div class="speed-control">
                <label>åŠ¨ç”»é€Ÿåº¦ï¼š</label>
                <input type="range" class="speed-slider" id="speed-slider" 
                       min="0.5" max="2" step="0.5" value="1">
                <span id="speed-label">1.0x</span>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            
            <div>
                <button class="action-btn" style="padding: 8px 20px;" onclick="resetDemo()">
                    ğŸ”„ é‡ç½®
                </button>
            </div>
        </div>
    </div>

    <!-- æç¤ºæ¡† -->
    <div class="tooltip" id="tooltip"></div>

    <script>
        // å…¨å±€çŠ¶æ€ç®¡ç†
        let currentMode = 'dev';
        let isProcessing = false;
        let animationSpeed = 1.0;
        let processSteps = [];
        let currentStep = 0;
        let startTime = 0;
        let dataFlow = {};

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            // é€Ÿåº¦æ§åˆ¶
            const speedSlider = document.getElementById('speed-slider');
            speedSlider.addEventListener('input', (e) => {
                animationSpeed = parseFloat(e.target.value);
                document.getElementById('speed-label').textContent = animationSpeed + 'x';
            });

            // æ·»åŠ èŠ‚ç‚¹æ‚¬åœæç¤º
            addNodeTooltips();
            
            // åˆå§‹åŒ–æ—¥å¿—
            addLog('ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ', 'success');
            addLog('ğŸ“ æ¬¢è¿ä½¿ç”¨RAGç³»ç»ŸV2.0å¯è§†åŒ–æ¼”ç¤º', 'info');
            addLog('ğŸ’¡ é€‰æ‹©ä¸åŒæ¨¡å¼ä½“éªŒå®Œæ•´æ•°æ®æµç¨‹', 'info');
        });
        
        // æ›´æ–°æŸ¥è¯¢è¾“å…¥
        function updateQueryInput() {
            const preset = document.getElementById('query-presets').value;
            document.getElementById('user-query').value = preset;
        }

        // åˆ‡æ¢æ¨¡å¼
        function switchMode(mode) {
            if (isProcessing) return;
            
            currentMode = mode;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // éšè—æ¶æ„å±‚æ¬¡ï¼ˆä»…åœ¨è¿è¡Œæ€æ˜¾ç¤ºï¼‰
            document.getElementById('architecture-layers').style.display = 'none';
            
            // æ›´æ–°æ§åˆ¶é¢æ¿
            document.getElementById('dev-controls').style.display = mode === 'dev' ? 'block' : 'none';
            document.getElementById('manage-controls').style.display = mode === 'manage' ? 'block' : 'none';
            document.getElementById('runtime-controls').style.display = mode === 'runtime' ? 'block' : 'none';
            
            // æ›´æ–°æµç¨‹å›¾
            document.getElementById('dev-flow').style.display = mode === 'dev' ? 'block' : 'none';
            document.getElementById('manage-flow').style.display = mode === 'manage' ? 'block' : 'none';
            document.getElementById('runtime-flow').style.display = mode === 'runtime' ? 'block' : 'none';
            
            // æ›´æ–°æ ‡é¢˜
            const titles = {
                'dev': 'ğŸ› ï¸ å¼€å‘æ€ - ç³»ç»Ÿåˆå§‹åŒ–',
                'manage': 'ğŸ“‹ ç®¡ç†æ€ - æ–‡æ¡£å¤„ç†',
                'runtime': 'ğŸš€ è¿è¡Œæ€ - æŸ¥è¯¢å¤„ç†'
            };
            document.getElementById('stage-title').textContent = titles[mode];
            
            // é‡ç½®èŠ‚ç‚¹çŠ¶æ€
            resetNodes();
            
            addLog(`åˆ‡æ¢åˆ°${titles[mode]}`, 'info');
            
            // æ ¹æ®æ¨¡å¼æ˜¾ç¤ºä¸åŒçš„æ•™å­¦å†…å®¹
            if (mode === 'runtime') {
                addLog('ğŸ“ è¿è¡Œæ€å°†å±•ç¤ºå®Œæ•´çš„V2.0åŒæ¨¡å‹å¤„ç†æµç¨‹', 'info');
                addLog('ğŸ’¡ åŒ…æ‹¬11ä¸ªå¤„ç†æ­¥éª¤å’Œæ™ºèƒ½è·¯ç”±å†³ç­–', 'info');
            } else if (mode === 'dev') {
                addLog('ğŸ”§ å¼€å‘æ€å°†å±•ç¤ºç³»ç»Ÿç»„ä»¶åˆå§‹åŒ–è¿‡ç¨‹', 'info');
            } else if (mode === 'manage') {
                addLog('ğŸ“ ç®¡ç†æ€å°†å±•ç¤ºæ–‡æ¡£å¤„ç†å’Œå‘é‡åŒ–æµç¨‹', 'info');
            }
        }

        // å¼€å‘æ€ï¼šåˆå§‹åŒ–ç³»ç»Ÿ
        function initializeSystem() {
            if (isProcessing) return;
            
            isProcessing = true;
            updateStatus('processing', 'åˆå§‹åŒ–ä¸­...');
            startTime = Date.now();
            
            addLog('ğŸ”„ å¼€å§‹ç³»ç»Ÿåˆå§‹åŒ–æµç¨‹', 'info');
            
            const steps = [
                { 
                    node: 'config-node', 
                    data: { 
                        'LLM_PROVIDER': 'deepseek',
                        'MODEL_REASON': 'DeepSeek-R1',
                        'MODEL_TOOLCALL': 'DeepSeek-V3',
                        'ANTHROPIC_API_KEY': 'claude_backup'
                    }, 
                    log: 'ğŸ“„ è¯»å–.envé…ç½®æ–‡ä»¶',
                    delay: 500 
                },
                { 
                    node: 'vectordb-node', 
                    data: { 
                        type: 'ChromaDB', 
                        path: './chroma_db',
                        collections: ['course_content', 'metadata']
                    }, 
                    log: 'ğŸ—Œï¸ åˆå§‹åŒ–å‘é‡æ•°æ®åº“',
                    delay: 800 
                },
                { 
                    node: 'embedding-node', 
                    data: { 
                        model: 'all-MiniLM-L6-v2', 
                        dimensions: 384,
                        max_length: 256
                    }, 
                    log: 'ğŸ”¢ åŠ è½½åµŒå…¥æ¨¡å‹',
                    delay: 600 
                },
                { 
                    node: 'ai-config-node', 
                    data: { 
                        api_key: 'sk-xxxxx...', 
                        base_url: 'https://api.deepseek.com/v1',
                        timeout: 30
                    }, 
                    log: 'ğŸ¤– é…ç½®AIæ¨¡å‹æ¥å£',
                    delay: 700 
                },
                { 
                    node: 'router-node', 
                    data: { 
                        strategy: 'task-based', 
                        models: ['V3-tools', 'R1-reasoning'],
                        fallback: 'Claude'
                    }, 
                    log: 'ğŸš€ å¯åŠ¨æ™ºèƒ½è·¯ç”±å™¨',
                    delay: 900 
                }
            ];
            
            processSequence(steps, () => {
                updateStatus('completed', 'ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
                updateMetrics({ time: ((Date.now() - startTime) / 1000).toFixed(1) });
                addLog('âœ… ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸ', 'success');
            });
        }

        // ç®¡ç†æ€ï¼šå¤„ç†æ–‡æ¡£
        function processDocument() {
            if (isProcessing) return;
            
            isProcessing = true;
            updateStatus('processing', 'å¤„ç†æ–‡æ¡£ä¸­...');
            startTime = Date.now();
            
            const docType = document.getElementById('doc-type').value;
            const docContents = {
                'python': `Course Title: Pythonç¼–ç¨‹åŸºç¡€
Course Instructor: å¼ è€å¸ˆ
Lesson 1: æ•°æ®ç±»å‹
Pythonçš„åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬ï¼š
- æ•´æ•°(int): å¦‚ 42, -10
- æµ®ç‚¹æ•°(float): å¦‚ 3.14, -0.001
- å­—ç¬¦ä¸²(str): å¦‚ "Hello", 'Python'
- å¸ƒå°”å€¼(bool): True, False`,
                'web': `Course Title: Webå¼€å‘å…¥é—¨
HTMLã€CSSã€JavaScriptåŸºç¡€...`,
                'data': `Course Title: æ•°æ®åˆ†æè¯¾ç¨‹
NumPyã€Pandasã€Matplotlibåº”ç”¨...`
            };
            
            const sampleDoc = docContents[docType];
            
            addLog(`ğŸ“ å¼€å§‹å¤„ç†${docType}æ–‡æ¡£`, 'info');
            
            const steps = [
                { 
                    node: 'doc-input-node', 
                    data: sampleDoc, 
                    log: 'ğŸ“¥ æ¥æ”¶æ–‡æ¡£å†…å®¹',
                    delay: 500 
                },
                { 
                    node: 'doc-parse-node', 
                    data: { 
                        title: 'è¯¾ç¨‹æ ‡é¢˜æå–æˆåŠŸ',
                        metadata: {
                            instructor: 'è®²å¸ˆä¿¡æ¯',
                            lessons: 'è¯¾ç¨‹ç« èŠ‚'
                        }
                    }, 
                    log: 'ğŸ” è§£ææ–‡æ¡£ç»“æ„',
                    delay: 800 
                },
                { 
                    node: 'chunk-node', 
                    data: { 
                        chunks: 5, 
                        chunk_size: 500,
                        overlap: 100,
                        strategy: 'recursive_character'
                    }, 
                    log: 'âœ‚ï¸ æ–‡æœ¬åˆ†å—å¤„ç†(500å­—ç¬¦/å—)',
                    delay: 1000 
                },
                { 
                    node: 'vectorize-node', 
                    data: { 
                        vectors: '[[0.23, -0.45, 0.67, ...], [0.12, 0.89, -0.34, ...], ...]',
                        model: 'all-MiniLM-L6-v2',
                        dimensions: 384
                    }, 
                    log: 'ğŸ”¢ ç”Ÿæˆ384ç»´å‘é‡è¡¨ç¤º',
                    delay: 1200 
                },
                { 
                    node: 'store-node', 
                    data: { 
                        stored_chunks: 5,
                        collection: 'course_content',
                        index_type: 'cosine_similarity'
                    }, 
                    log: 'ğŸ’¾ å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“',
                    delay: 600 
                }
            ];
            
            processSequence(steps, () => {
                updateStatus('completed', 'æ–‡æ¡£å¤„ç†å®Œæˆ');
                updateMetrics({ 
                    time: ((Date.now() - startTime) / 1000).toFixed(1),
                    chunks: 5
                });
                addLog('âœ… æ–‡æ¡£å¤„ç†æˆåŠŸï¼Œå·²å­˜å‚¨5ä¸ªæ–‡æœ¬å—', 'success');
            });
        }

        // è¿è¡Œæ€ï¼šå¤„ç†æŸ¥è¯¢ - å®Œæ•´V2.0æµç¨‹
        function startQueryProcess() {
            if (isProcessing) return;
            
            isProcessing = true;
            const query = document.getElementById('user-query').value;
            updateStatus('processing', 'å¤„ç†æŸ¥è¯¢ä¸­...');
            startTime = Date.now();
            
            // æ˜¾ç¤ºè·¯ç”±å†³ç­–å’Œæ¨¡å‹åˆ‡æ¢ç»„ä»¶
            document.getElementById('router-details').style.display = 'block';
            document.getElementById('vector-section').style.display = 'block';
            document.getElementById('search-section').style.display = 'block';
            
            // æ›´æ–°è¾“å…¥æ•°æ®æ˜¾ç¤º
            document.getElementById('input-data').innerHTML = `
<strong>ğŸ” ç”¨æˆ·æŸ¥è¯¢ï¼š</strong>
${query}

<strong>ğŸ†” ä¼šè¯ IDï¼š</strong>
session_abc123

<strong>â° æ—¶é—´æˆ³ï¼š</strong>
${new Date().toLocaleString()}`;
            
            addLog(`ğŸ¯ å¼€å§‹å¤„ç†æŸ¥è¯¢: "${query}"`, 'info');
            
            // æ˜¾ç¤ºæ¶æ„å±‚æ¬¡
            document.getElementById('architecture-layers').style.display = 'block';
            
            // V2.0å®Œæ•´å¤„ç†æµç¨‹ - 11æ­¥å®Œæ•´æµç¨‹
            const steps = [
                // 1. ç”¨æˆ·è¾“å…¥
                { 
                    node: 'user-input', 
                    data: { query: query },
                    log: 'æ¥æ”¶ç”¨æˆ·æŸ¥è¯¢',
                    delay: 300 
                },
                // 2. APIæ¥æ”¶
                { 
                    node: 'api-receive', 
                    data: { method: 'POST /api/query', body: { query, session_id: 'abc123' } },
                    log: 'FastAPIæ¥æ”¶è¯·æ±‚',
                    delay: 400 
                },
                // 3. ä¼šè¯ç®¡ç†
                { 
                    node: 'session-mgmt', 
                    data: { history: '[]', session_id: 'abc123' },
                    log: 'è·å–ä¼šè¯å†å²',
                    delay: 500 
                },
                // 4. å·¥å…·å‡†å¤‡
                { 
                    node: 'tool-prep', 
                    data: { tools: ['search_course'], format: 'OpenAI' },
                    log: 'å‡†å¤‡å·¥å…·å®šä¹‰ï¼ˆæ ¼å¼è½¬æ¢ï¼‰',
                    delay: 600 
                },
                // 5. è·¯ç”±å†³ç­– - æ ¸å¿ƒ
                { 
                    node: 'router-decision', 
                    data: { decision: 'need_tool_call', reason: 'æŸ¥è¯¢åŒ…å«è¯¾ç¨‹å†…å®¹é—®é¢˜' },
                    log: 'ğŸš¦ æ™ºèƒ½è·¯ç”±å†³ç­–ï¼šéœ€è¦å·¥å…·è°ƒç”¨',
                    callback: () => showRouterDecision(true),
                    delay: 800 
                },
                // 6. é€‰æ‹©V3æ¨¡å‹
                { 
                    node: 'model-v3', 
                    data: { model: 'DeepSeek-V3', task: 'tool_calling' },
                    log: 'é€‰æ‹©DeepSeek-V3å¤„ç†å·¥å…·è°ƒç”¨',
                    delay: 700 
                },
                // 7. å·¥å…·è°ƒç”¨
                { 
                    node: 'tool-call', 
                    data: { tool: 'search_course', args: { query: 'Pythonæ•°æ®ç±»å‹' } },
                    log: 'æ‰§è¡Œæœç´¢å·¥å…·',
                    delay: 900 
                },
                // 8. å‘é‡æœç´¢
                { 
                    node: 'vector-search', 
                    data: { 
                        results: [
                            { chunk: 'åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬ï¼šint, float, str, bool', score: 0.92 },
                            { chunk: 'å˜é‡æ˜¯å­˜å‚¨æ•°æ®çš„å®¹å™¨', score: 0.85 }
                        ]
                    },
                    log: 'å‘é‡æ•°æ®åº“æœç´¢å®Œæˆ',
                    callback: () => updateSearchResults(),
                    delay: 1000 
                },
                // 9. æ¨¡å‹åˆ‡æ¢
                { 
                    node: 'model-switch', 
                    data: { from: 'V3', to: 'R1', reason: 'éœ€è¦æ•´åˆæœç´¢ç»“æœ' },
                    log: 'ğŸ”„ æ¨¡å‹åˆ‡æ¢ï¼šV3 â†’ R1',
                    callback: () => showModelSwitch(),
                    delay: 800 
                },
                // 10. ç»“æœæ•´åˆ
                { 
                    node: 'result-integrate', 
                    data: { model: 'DeepSeek-R1', task: 'reasoning' },
                    log: 'R1æ¨¡å‹æ•´åˆæœç´¢ç»“æœ',
                    delay: 1200 
                },
                // 11. æœ€ç»ˆå“åº”
                { 
                    node: 'final-response', 
                    data: { 
                        answer: 'Pythonçš„åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬ï¼šæ•´æ•°(int)ã€æµ®ç‚¹æ•°(float)ã€å­—ç¬¦ä¸²(str)ã€å¸ƒå°”å€¼(bool)ã€‚',
                        sources: ['Pythonç¼–ç¨‹åŸºç¡€ - Lesson 1'],
                        confidence: 0.95,
                        model_path: 'V3(å·¥å…·) â†’ R1(æ¨ç†)'
                    },
                    log: 'âœ… ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ',
                    callback: () => showFinalResponse(),
                    delay: 600 
                }
            ];
            
            processSequence(steps, () => {
                updateStatus('completed', 'æŸ¥è¯¢å¤„ç†å®Œæˆ');
                const totalTime = ((Date.now() - startTime) / 1000).toFixed(1);
                updateMetrics({ 
                    time: totalTime,
                    tokens: 250,
                    cost: 0.005
                });
                
                addLog(`âœ… æŸ¥è¯¢å¤„ç†å®Œæˆï¼Œè€—æ—¶ ${totalTime}ç§’`, 'success');
                addLog(`ğŸ“Š å¤„ç†è·¯å¾„: V3(å·¥å…·) â†’ R1(æ¨ç†)`, 'info');
                addLog(`ğŸ† V2.0åŒæ¨¡å‹æ¶æ„æˆåŠŸå®Œæˆä»»åŠ¡`, 'success');
                
                // éšè—æ¶æ„å±‚æ¬¡
                setTimeout(() => {
                    document.getElementById('architecture-layers').style.display = 'none';
                }, 3000);
            });
        }

        // æ˜¾ç¤ºè·¯ç”±å†³ç­–è¿‡ç¨‹
        function showRouterDecision(needTool) {
            const nodes = ['check-tools', 'select-model', 'route-path'];
            nodes.forEach((nodeId, index) => {
                setTimeout(() => {
                    const node = document.getElementById(nodeId);
                    node.classList.add('selected');
                    
                    if (nodeId === 'select-model') {
                        node.textContent = needTool ? 'é€‰æ‹© V3' : 'é€‰æ‹© R1';
                    } else if (nodeId === 'route-path') {
                        node.textContent = needTool ? 'å·¥å…·è°ƒç”¨è·¯å¾„' : 'ç›´æ¥æ¨ç†è·¯å¾„';
                    }
                }, index * 300 / animationSpeed);
            });
        }

        // æ˜¾ç¤ºæ¨¡å‹åˆ‡æ¢åŠ¨ç”»
        function showModelSwitch() {
            const switchViz = document.getElementById('model-switch-viz');
            switchViz.style.display = 'flex';
            
            setTimeout(() => {
                document.getElementById('v3-card').classList.add('active');
            }, 200 / animationSpeed);
            
            setTimeout(() => {
                document.getElementById('v3-card').classList.remove('active');
                document.getElementById('r1-card').classList.add('active');
            }, 800 / animationSpeed);
            
            setTimeout(() => {
                switchViz.style.display = 'none';
                document.getElementById('r1-card').classList.remove('active');
            }, 2000 / animationSpeed);
        }

        // æ›´æ–°æœç´¢ç»“æœ
        function updateSearchResults() {
            const results = [
                { 
                    text: 'Pythonçš„åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬ï¼šæ•´æ•°(int)ã€æµ®ç‚¹æ•°(float)ã€å­—ç¬¦ä¸²(str)ã€å¸ƒå°”å€¼(bool)', 
                    score: 0.92,
                    source: 'Lesson 1: æ•°æ®ç±»å‹'
                },
                { 
                    text: 'åœ¨Pythonä¸­ï¼Œå˜é‡æ˜¯å­˜å‚¨æ•°æ®çš„å®¹å™¨ï¼Œå¯ä»¥å­˜å‚¨ä¸åŒç±»å‹çš„æ•°æ®', 
                    score: 0.85,
                    source: 'Lesson 2: å˜é‡'
                },
                { 
                    text: 'ç±»å‹è½¬æ¢å‡½æ•°ï¼šint(), float(), str(), bool()', 
                    score: 0.73,
                    source: 'Lesson 3: ç±»å‹è½¬æ¢'
                }
            ];
            
            let html = '<strong>ğŸ” å‘é‡æœç´¢ç»“æœï¼š</strong>\n\n';
            results.forEach((r, i) => {
                html += `${i+1}. [ç›¸ä¼¼åº¦: ${r.score}] ${r.source}\n   ${r.text}\n\n`;
            });
            
            document.getElementById('search-results').textContent = html;
            
            // æ›´æ–°å‘é‡æ•°æ®æ˜¾ç¤º
            document.getElementById('vector-data').innerHTML = `
<strong>ğŸ”¢ æŸ¥è¯¢å‘é‡ï¼š</strong>
[0.23, -0.45, 0.67, 0.12, ..., 0.89] (384ç»´)

<strong>ğŸ¯ åŒ¹é…ç­–ç•¥ï¼š</strong>
ä½™å¼¦ç›¸ä¼¼åº¦ (Cosine Similarity)

<strong>ğŸ” Top-Kï¼š</strong>
è¿”å›å‰3ä¸ªæœ€ç›¸å…³ç»“æœ`;
        }
        
        // æ˜¾ç¤ºæœ€ç»ˆå“åº”
        function showFinalResponse() {
            const totalTime = ((Date.now() - startTime) / 1000).toFixed(1);
            document.getElementById('output-data').innerHTML = `
<strong>ğŸ¤– AIç”Ÿæˆç­”æ¡ˆï¼š</strong>

Pythonçš„åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬ï¼š

1. <strong>æ•´æ•°(int)</strong> - æ•´æ•°å€¼
   ç¤ºä¾‹: 42, -10, 0
   
2. <strong>æµ®ç‚¹æ•°(float)</strong> - å°æ•°å€¼
   ç¤ºä¾‹: 3.14, -0.001, 2.0
   
3. <strong>å­—ç¬¦ä¸²(str)</strong> - æ–‡æœ¬æ•°æ®
   ç¤ºä¾‹: "Hello", 'Python', '''text'''
   
4. <strong>å¸ƒå°”å€¼(bool)</strong> - çœŸ/å‡å€¼
   å€¼: True, False

<strong>ğŸ“– ä¿¡æ¯æ¥æºï¼š</strong>
Pythonç¼–ç¨‹åŸºç¡€ - Lesson 1: æ•°æ®ç±»å‹

<strong>ğŸ”„ å¤„ç†è·¯å¾„ï¼š</strong>
DeepSeek-V3(å·¥å…·è°ƒç”¨) â†’ DeepSeek-R1(ç»“æœæ•´åˆ)

<strong>ğŸ“Š ç»Ÿè®¡ä¿¡æ¯ï¼š</strong>
â€¢ ç½®ä¿¡åº¦: 95%
â€¢ å¤„ç†æ—¶é—´: ${totalTime}ç§’
â€¢ æœç´¢å‘½ä¸­: 3ä¸ªç›¸å…³æ–‡æ¡£å—`;
        }

        // å¤„ç†æ­¥éª¤åºåˆ—
        function processSequence(steps, callback) {
            let index = 0;
            
            function processNext() {
                if (index >= steps.length) {
                    isProcessing = false;
                    if (callback) callback();
                    return;
                }
                
                const step = steps[index];
                
                // æ¿€æ´»èŠ‚ç‚¹
                const node = document.getElementById(step.node);
                if (node) {
                    // æ¸…é™¤ä¹‹å‰çš„çŠ¶æ€
                    document.querySelectorAll('.flow-node').forEach(n => {
                        if (n.id !== step.node && !n.classList.contains('completed')) {
                            n.classList.remove('active');
                        }
                    });
                    
                    node.classList.add('active');
                    
                    // æ›´æ–°å¯¹åº”çš„æ–‡æœ¬
                    const textNode = node.nextElementSibling;
                    if (textNode && textNode.classList.contains('node-text')) {
                        textNode.classList.add('active');
                    }
                }
                
                // æ›´æ–°æ•°æ®é¢æ¿
                updateDataPanel(step.node, step.data);
                
                // æ·»åŠ æ—¥å¿—
                if (step.log) {
                    addLog(step.log, 'info');
                }
                
                // æ‰§è¡Œå›è°ƒ
                if (step.callback) {
                    step.callback();
                }
                
                // æ›´æ–°è¿›åº¦
                updateProgress((index + 1) / steps.length * 100);
                
                // è®¾ç½®å®ŒæˆçŠ¶æ€å¹¶å¤„ç†ä¸‹ä¸€æ­¥
                setTimeout(() => {
                    if (node) {
                        node.classList.remove('active');
                        node.classList.add('completed');
                        
                        const textNode = node.nextElementSibling;
                        if (textNode && textNode.classList.contains('node-text')) {
                            textNode.classList.remove('active');
                        }
                    }
                    
                    index++;
                    processNext();
                }, step.delay / animationSpeed);
            }
            
            processNext();
        }

        // æ›´æ–°æ•°æ®é¢æ¿
        function updateDataPanel(nodeId, data) {
            const inputEl = document.getElementById('input-data');
            const processingEl = document.getElementById('processing-data');
            const vectorEl = document.getElementById('vector-data');
            const outputEl = document.getElementById('output-data');
            
            // æ ¹æ®èŠ‚ç‚¹æ›´æ–°ä¸åŒçš„æ•°æ®åŒºåŸŸ
            if (nodeId.includes('input') || nodeId === 'user-input') {
                inputEl.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
            } else if (nodeId.includes('vector')) {
                vectorEl.textContent = JSON.stringify(data, null, 2);
            } else if (nodeId.includes('final') || nodeId.includes('response')) {
                // è¾“å‡ºæ•°æ®åœ¨å®Œæˆå›è°ƒä¸­å¤„ç†
            } else {
                processingEl.textContent = JSON.stringify(data, null, 2);
            }
        }

        // æ›´æ–°çŠ¶æ€
        function updateStatus(status, text) {
            const statusEl = document.getElementById('system-status');
            const statusMap = {
                'waiting': 'â¸ï¸ ç­‰å¾…æ“ä½œ',
                'processing': 'âš™ï¸ ' + (text || 'å¤„ç†ä¸­...'),
                'completed': 'âœ… ' + (text || 'å®Œæˆ'),
                'error': 'âŒ ' + (text || 'é”™è¯¯')
            };
            
            statusEl.innerHTML = `<span class="status-indicator ${status}">${statusMap[status]}</span>`;
        }

        // æ›´æ–°æŒ‡æ ‡
        function updateMetrics(metrics) {
            if (metrics.time !== undefined) {
                document.getElementById('time-metric').textContent = metrics.time + 's';
            }
            if (metrics.tokens !== undefined) {
                document.getElementById('token-metric').textContent = metrics.tokens;
            }
            if (metrics.chunks !== undefined) {
                document.getElementById('chunks-metric').textContent = metrics.chunks;
            }
            if (metrics.cost !== undefined) {
                document.getElementById('cost-metric').textContent = '$' + metrics.cost.toFixed(3);
            }
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress(percent) {
            document.getElementById('progress-fill').style.width = percent + '%';
        }

        // æ·»åŠ æ—¥å¿—
        function addLog(message, type = 'info') {
            const logEl = document.getElementById('process-log');
            const time = new Date().toLocaleTimeString();
            const icons = {
                'info': 'â„¹ï¸',
                'success': 'âœ…',
                'warning': 'âš ï¸',
                'error': 'âŒ'
            };
            
            const logEntry = `[${time}] ${icons[type]} ${message}\n`;
            logEl.textContent = logEntry + logEl.textContent;
            
            // é™åˆ¶æ—¥å¿—é•¿åº¦
            const lines = logEl.textContent.split('\n');
            if (lines.length > 20) {
                logEl.textContent = lines.slice(0, 20).join('\n');
            }
        }

        // é‡ç½®èŠ‚ç‚¹çŠ¶æ€
        function resetNodes() {
            document.querySelectorAll('.flow-node').forEach(node => {
                node.classList.remove('active', 'completed', 'error');
            });
            document.querySelectorAll('.node-text').forEach(text => {
                text.classList.remove('active');
            });
            document.querySelectorAll('.pipeline-path').forEach(path => {
                path.classList.remove('active');
            });
            
            // éšè—ç‰¹æ®Šç»„ä»¶
            document.getElementById('router-details').style.display = 'none';
            document.getElementById('model-switch-viz').style.display = 'none';
            
            // é‡ç½®å†³ç­–èŠ‚ç‚¹
            document.querySelectorAll('.decision-node').forEach(node => {
                node.classList.remove('selected', 'not-selected');
            });
            
            updateProgress(0);
        }

        // é‡ç½®æ¼”ç¤º
        function resetDemo() {
            isProcessing = false;
            currentStep = 0;
            
            resetNodes();
            updateStatus('waiting');
            updateMetrics({ time: 0, tokens: 0, chunks: 0, cost: 0 });
            
            // æ¸…ç©ºæ•°æ®é¢æ¿
            document.getElementById('input-data').textContent = 'ç­‰å¾…è¾“å…¥...';
            document.getElementById('processing-data').textContent = 'ç­‰å¾…å¤„ç†...';
            document.getElementById('vector-data').textContent = 'ç­‰å¾…å‘é‡åŒ–...';
            document.getElementById('search-results').textContent = 'ç­‰å¾…æœç´¢...';
            document.getElementById('output-data').textContent = 'ç­‰å¾…è¾“å‡º...';
            
            addLog('ğŸ”„ ç³»ç»Ÿå·²é‡ç½®', 'info');
        }

        // æ·»åŠ èŠ‚ç‚¹æç¤º
        function addNodeTooltips() {
            const tooltips = {
                // å¼€å‘æ€èŠ‚ç‚¹
                'config-node': 'ğŸ“„ é…ç½®è¯»å–\nè¯»å–.envæ–‡ä»¶ä¸­çš„é…ç½®ï¼š\nâ€¢ LLM_PROVIDER: æ¨¡å‹æä¾›å•†\nâ€¢ APIå¯†é’¥å’Œç«¯ç‚¹\nâ€¢ æ¨¡å‹é€‰æ‹©å‚æ•°',
                'vectordb-node': 'ğŸ—Œï¸ ChromaDBæ•°æ®åº“\nå‘é‡æ•°æ®åº“åˆå§‹åŒ–ï¼š\nâ€¢ åˆ›å»ºcollection\nâ€¢ è®¾ç½®ç´¢å¼•ç±»å‹\nâ€¢ å‡†å¤‡å­˜å‚¨ç©ºé—´',
                'embedding-node': 'ğŸ”¢ åµŒå…¥æ¨¡å‹\nall-MiniLM-L6-v2ï¼š\nâ€¢ 384ç»´å‘é‡è¾“å‡º\nâ€¢ å¤šè¯­è¨€æ”¯æŒ\nâ€¢ é«˜æ•ˆè¯­ä¹‰ç†è§£',
                'ai-config-node': 'ğŸ¤– AIæ¨¡å‹é…ç½®\nè®¾ç½®æ¨¡å‹å‚æ•°ï¼š\nâ€¢ APIåŸºç¡€URL\nâ€¢ è¶…æ—¶è®¾ç½®\nâ€¢ é‡è¯•ç­–ç•¥',
                'router-node': 'ğŸš€ æ™ºèƒ½è·¯ç”±å™¨\nä»»åŠ¡è·¯ç”±ç­–ç•¥ï¼š\nâ€¢ å·¥å…·è°ƒç”¨â†’V3\nâ€¢ ç›´æ¥æ¨ç†â†’R1\nâ€¢ é™çº§æœºåˆ¶â†’Claude',
                
                // ç®¡ç†æ€èŠ‚ç‚¹
                'doc-input-node': 'ğŸ“¥ æ–‡æ¡£è¾“å…¥\næ”¯æŒæ ¼å¼ï¼š\nâ€¢ Markdown (.md)\nâ€¢ PDFæ–‡æ¡£\nâ€¢ çº¯æ–‡æœ¬ (.txt)',
                'doc-parse-node': 'ğŸ” æ–‡æ¡£è§£æ\næå–å†…å®¹ï¼š\nâ€¢ æ ‡é¢˜å’Œå…ƒæ•°æ®\nâ€¢ ç« èŠ‚ç»“æ„\nâ€¢ æ­£æ–‡å†…å®¹',
                'chunk-node': 'âœ‚ï¸ æ–‡æœ¬åˆ†å—\nåˆ†å—ç­–ç•¥ï¼š\nâ€¢ æ¯å—500å­—ç¬¦\nâ€¢ 100å­—ç¬¦é‡å \nâ€¢ ä¿æŒè¯­ä¹‰å®Œæ•´',
                'vectorize-node': 'ğŸ”¢ å‘é‡åŒ–\nè½¬æ¢è¿‡ç¨‹ï¼š\nâ€¢ æ–‡æœ¬â†’Token\nâ€¢ Tokenâ†’å‘é‡\nâ€¢ 384ç»´è¾“å‡º',
                'store-node': 'ğŸ’¾ æ•°æ®å­˜å‚¨\nå­˜å‚¨åˆ°ChromaDBï¼š\nâ€¢ å‘é‡ç´¢å¼•\nâ€¢ å…ƒæ•°æ®å…³è”\nâ€¢ æ”¯æŒå¿«é€Ÿæ£€ç´¢',
                
                // è¿è¡Œæ€èŠ‚ç‚¹
                'user-input': 'ğŸ” ç”¨æˆ·è¾“å…¥\næ¥æ”¶ç”¨æˆ·æŸ¥è¯¢\nå‡†å¤‡å¤„ç†æµç¨‹',
                'api-receive': 'ğŸŒ APIæ¥æ”¶\nFastAPIç«¯ç‚¹ï¼š\nPOST /api/query',
                'session-mgmt': 'ğŸ“‹ ä¼šè¯ç®¡ç†\nç»´æŠ¤å¯¹è¯ä¸Šä¸‹æ–‡\nè·Ÿè¸ªå†å²è®°å½•',
                'tool-prep': 'ğŸ”§ å·¥å…·å‡†å¤‡\næ ¼å¼è½¬æ¢ï¼š\nClaudeâ†”OpenAI',
                'router-decision': 'ğŸ˜¦ è·¯ç”±å†³ç­–\næ™ºèƒ½åˆ¤æ–­ï¼š\nâ€¢ éœ€è¦æœç´¢â†’V3\nâ€¢ ç›´æ¥å›ç­”â†’R1',
                'model-v3': 'ğŸ”§ DeepSeek-V3\nå·¥å…·è°ƒç”¨ä¸“å®¶ï¼š\nâ€¢ å‡½æ•°è°ƒç”¨\nâ€¢ å‚æ•°æå–\nâ€¢ APIäº¤äº’',
                'model-r1-direct': 'ğŸ§  DeepSeek-R1\næ¨ç†ä¸“å®¶ï¼š\nâ€¢ æ·±åº¦æ€è€ƒ\nâ€¢ é€»è¾‘æ¨ç†\nâ€¢ ç»“æœæ•´åˆ',
                'tool-call': 'ğŸ› ï¸ å·¥å…·è°ƒç”¨\næ‰§è¡Œsearch_course\nä¼ é€’æŸ¥è¯¢å‚æ•°',
                'vector-search': 'ğŸ” å‘é‡æœç´¢\nä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—\nè¿”å›Top-Kç»“æœ',
                'model-switch': 'ğŸ”„ æ¨¡å‹åˆ‡æ¢\nV3â†’R1åˆ‡æ¢ï¼š\nä»å·¥å…·æ¨¡å¼\nåˆ‡æ¢åˆ°æ¨ç†æ¨¡å¼',
                'result-integrate': 'ğŸ§© ç»“æœæ•´åˆ\nR1æ•´åˆå¤„ç†ï¼š\nâ€¢ åˆ†ææœç´¢ç»“æœ\nâ€¢ ç»„ç»‡ç­”æ¡ˆ\nâ€¢ æ·»åŠ æ¥æº',
                'final-response': 'ğŸ“¤ æœ€ç»ˆå“åº”\nè¿”å›ç»™ç”¨æˆ·ï¼š\nâ€¢ ç­”æ¡ˆå†…å®¹\nâ€¢ ä¿¡æ¯æ¥æº\nâ€¢ å¤„ç†è·¯å¾„'
            };
            
            Object.keys(tooltips).forEach(nodeId => {
                const node = document.getElementById(nodeId);
                if (node) {
                    node.addEventListener('mouseenter', (e) => {
                        showTooltip(e, tooltips[nodeId]);
                    });
                    node.addEventListener('mouseleave', hideTooltip);
                }
            });
        }

        // æ˜¾ç¤ºæç¤ºæ¡†
        function showTooltip(event, text) {
            const tooltip = document.getElementById('tooltip');
            // æ”¯æŒå¤šè¡Œæ–‡æœ¬
            tooltip.innerHTML = text.replace(/\n/g, '<br>');
            
            // è®¡ç®—ä½ç½®ï¼Œé¿å…è¶…å‡ºå±å¹•
            const x = event.pageX;
            const y = event.pageY - 40;
            
            tooltip.style.left = x + 'px';
            tooltip.style.top = y + 'px';
            tooltip.classList.add('show');
        }

        // éšè—æç¤ºæ¡†
        function hideTooltip() {
            document.getElementById('tooltip').classList.remove('show');
        }

        // æ›´æ–°æ¨¡å‹é…ç½®
        function updateModelConfig() {
            const provider = document.getElementById('model-provider').value;
            addLog(`åˆ‡æ¢åˆ° ${provider} æ¨¡å‹é…ç½®`, 'info');
        }
    </script>
</body>
</html>